
<html>

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatiible" content="IE=edge">
    <meta name="viewpoint" content="width=device-width, initial-scale=1.0">
    <title>Add more field using bootstrap 5, jQuery & PHP</title>
    <link rel='stylesheet'
        href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.1.1/css/bootstrap.min.css' />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.js"></script> 
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.js"></script> 
    <link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/themes/ui-lightness/jquery-ui.css" rel="stylesheet" type="text/css" /> 
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='/simple.css') }}" />
</head>
<body>

    <div class="bg=dark">
        <div class="container">
            <div class="row my-4">
                <div class="col-lg-10 mx-auto">
                    <div class="col">
                        <div class="card-header" >
                            <h4>Scrutany</h4>
                        </div><br>
                        <div align="center" >
                            <form action="/scrutanybuttion" method="POST" align="center">
                                <div class="text-center">
                                    <button type="submit" class="btn btn-primary m-3">Scrutany</button>
                                </div>
                            </form>

                            {% if result|length > 0 %}
                            <form>
                                <h2>Search Results</h2>
                                <table class="table table-striped table-bordered" border="5">
                                    <thead>
                                        <tr>
                                            <th>Radio Column</th>
                                            <th scope="col">Sr.no</th>
                                            <th scope="col">faculty</th>
                                            <th scope="col">year</th>
                                            <th scope="col">sem</th>
                                            <th scope="col">subject</th>
                                            <th scope="col">coursename</th>
                                            <th scope="col">course_id</th>
                                            <th scope="col">count</th>
                                            <th scope="col">quespaper_code</th>
                                            <th scope="col">Remaining scrutany Paper Count</th>

                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% for result in result %}
                                        <tr>
                                            <td>
                                                <input type="radio" name="selected_row" class="radio-container" data-faculty="{{ result[0] }}"
                                                data-year="{{ result[1] }}" data-sem="{{ result[2] }}" data-subject="{{ result[3] }}"
                                                data-coursename="{{ result[4] }}" data-course_id="{{ result[5] }}"
                                                data-count="{{ result[6] }}" data-quespaper_code="{{ result[7] }}"
                                                data-timetable_id="{{ result[9] }}"
                                                data-papercount_id="{{ result[8] }}" id="radio_{{ loop.index }}"
                                                onclick="displaySelectedRow(this)">

                                            </td>
                                            <td>{{ loop.index }}</td>
                                            <td>{{ result[7] }}</td>
                                            <td>{{ result[2] }}</td>
                                            <td>{{ result[3] }}</td>
                                            <td>{{ result[4] }}</td>
                                            <td>{{ result[5] }}</td>
                                            <td>{{ result[6] }}</td>
                                            <td>{{ result[1] }}</td>
                                            <td>{{ result[0] }}</td>
                                            <td>{{ result[10] }}</td>

                                            <!-- <input type="hidden" name="timetable_id[]" value="{{ result[8] }}">
                                            <input type="hidden" name="papercount_id[]" value="{{ result[9] }}">
                                            <input type="hidden" name="capfaculty_id[]" value="{{ result[10] }}"> -->

                                            <input type="hidden" name="timetable_id[]" value="{{ result[9] }}">
                                            <input type="hidden" name="papercount_id[]" value="{{ result[8] }}">
                                            <!-- <input type="hidden" name="capfaculty_id[]" value="{{ result[9] }}"> -->

                                        </tr>
                                        {% endfor %}    
                                      
                                    </tbody>
                                </table>
                            </form>
                            <form action='/paper_scrutany' method="POST">
                                <h2 id="selected_row_heading" style="display: none;">Selected Row</h2>
                                <table id="selected_row_table" class="table table-striped table-bordered" border="1" style="display: none;">
                                    <thead>
                                        <tr>
                                            <th style="font-size: 12px; width: 5%;">Sr.no</th>
                                            <th style="font-size: 12px; width: 10%;">faculty</th>
                                            <th style="font-size: 12px; width: 7%;">year</th>
                                            <th style="font-size: 12px; width: 7%;">sem</th>
                                            <th style="font-size: 12px; width: 15%;">subject</th>
                                            <th style="font-size: 12px; width: 15%;">coursename</th>
                                            <th style="font-size: 12px; width: 7%;">Course id</th>
                                            <th style="font-size: 12px; width: 5%;">count</th>
                                            <th style="font-size: 12px; width: 10%;">Quespaper code</th>
                                            <th style="font-size: 12px; width: 7%;">Remaining scrutany Paper</th>
                                            <th style="font-size: 12px; width: 7%;">from Paper_count</th>
                                            <th style="font-size: 12px; width: 7%;">To Paper_count</th>
                                            <th style="font-size: 12px; width: 10%;">Scrutany Paper count</th>
                                            <th style="font-size: 12px; width: 10%;">Issue Date</th>
                                            <th style="font-size: 12px; width: 10%;">Received Date</th>
                                            <th style="font-size: 12px; width: 10%;">Scrutany Name</th>
                                        </tr>
                                    </thead>
                                    <tbody id="selected_row_body">
                                        {% for data in result %}
                                        <tr>
                                            <td style="font-size: 12px; width: 5%;">{{ loop.index }}</td>
                                            <td style="font-size: 10px; width: 10%;">{{ data[0] }}</td>
                                            <td style="font-size: 10px; width: 7%;">{{ data[1] }}</td>
                                            <td style="font-size: 10px; width: 7%;">{{ data[2] }}</td>
                                            <td style="font-size: 10px; width: 15%;">{{ data[3] }}</td>
                                            <td style="font-size: 10px; width: 15%;">{{ data[4] }}</td>
                                            <td style="font-size: 10px; width: 7%;">{{ data[5] }}</td>
                                            <td style="font-size: 10px; width: 5%;">{{ data[6] }}</td>
                                            <td style="font-size: 10px; width: 10%;">{{ data[7] }}</td>
                                            <td style="font-size: 10px; width: 10%;">{{ data[10] }}</td>    
                                        
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                                <div class="text-center">
                                    <button type="submit" class="btn btn-primary m-3">Scrutany</button>
                                </div>
                            </form>

                            {% endif %}
                        </div>
                    </div>
                           
                </div>
            </div>
        </div>
    </div>

    <script>

            var countfrom = 0
            var countto = 0
            function updateCount() {
                let totalCount = document.getElementById("totalCount");
                let count = countto - countfrom
                console.log("count = ", count)
                if (count > 0) {
                    totalCount.value = count+1
                    totalCount.innerText = count+1
                }
                else {
                    totalCount.innerText = ""
                    totalCount.value = 0
                }
            }
            function fromCountChange() {
                countfrom = document.getElementById("from_count").value;
                console.log("countfrom: ", countfrom)
                updateCount()
            }

            function toCountChange() {
                countto = document.getElementById("to_count").value;
                console.log("countto: ", countto)
                updateCount()
            }
        function displaySelectedRow(radio) {
            if (radio.checked) {
                var row = radio.parentNode.parentNode;
                var selectedRowBody = document.getElementById('selected_row_body');
                selectedRowBody.innerHTML = '';
                var newRow = selectedRowBody.insertRow();
                for (var i = 1; i < row.cells.length; i++) {
                    var cell = newRow.insertCell();
                    cell.textContent = row.cells[i].textContent;
                }

                // Add input fields for additional columns

                var fromPaperCountCell = newRow.insertCell();
                fromPaperCountCell.innerHTML = '<input type="text" name="from_count"  id="from_count" onchange="fromCountChange()" required>'

                var toPaperCountCell = newRow.insertCell();
                toPaperCountCell.innerHTML = '<input type="text" name="to_count"  id="to_count" onchange="toCountChange()"  required>'

                
                var scrutanyPaperCountCell = newRow.insertCell();
                scrutanyPaperCountCell.innerHTML = '<input type="text" name="scrutany_paper_count"   id="totalCount"  readonly tabindex="-1">'
        

                var issueDateCell = newRow.insertCell();
                issueDateCell.innerHTML = '<input type="date" name="issue_date" required>'

                var receiveDateCell = newRow.insertCell();
                receiveDateCell.innerHTML = '<input type="date" name="return_date">'

                var teacherPaperCountCell = newRow.insertCell();
                teacherPaperCountCell.innerHTML = `<SELECT id="capfaculty_id" name="capfaculty_id" class="form-control">
                    {% for j in joblist1 %}
                    <OPTION value={{j[1]}}>{{j[0]}}</OPTION>
                    {% endfor %}
                    </SELECT>`

                var paperIdInput = document.createElement('input');
                paperIdInput.type = 'hidden';
                paperIdInput.name = 'papercount_id';
                paperIdInput.value = radio.dataset.papercount_id;
                newRow.appendChild(paperIdInput);

                var timetableIdInput = document.createElement('input');
                timetableIdInput.type = 'hidden';
                timetableIdInput.name = 'timetable_id';
                timetableIdInput.value = radio.dataset.timetable_id;
                newRow.appendChild(timetableIdInput);

                document.getElementById('selected_row_heading').style.display = 'block';
                document.getElementById('selected_row_table').style.display = 'block';
            } else {
                document.getElementById('selected_row_heading').style.display = 'none';
                document.getElementById('selected_row_table').style.display = 'none';
            }
        }
    
        
         

        
    
    </script>
</body>
</html>

